%table.candidates
  %thead
    %tr
      %th.candidate Candidate
      %th.n-votes
        - if race.n_votes_is_really_n_sdes
          %abbr{title: 'State Delegate Equivalents'} SDEs
          %sup> ∗
        - else
          Votes
      %th.percent-vote= '%'
      %th.n-delegates Delegates
      - if race.has_pollster_data?
        %th.pollster Polling Average 
  %tbody
    - race.candidate_races.each do |candidate_race|
      - candidate = candidate_race.candidate
      %tr{'data-candidate-id': candidate.id, class: (candidate_race.winner? ? 'winner' : '')}
        %td.candidate
          %img{src: image_path("#{candidate.slug}.png"), alt: ''}
          %span.name= candidate.name
        %td.n-votes= format_int(candidate_race.n_votes)
        %td.percent-vote= format_percent_or_nil(candidate_race.percent_vote)
        %td.n-delegates
          .n-delegates-inner
            %span.n-delegates-int= format_int(candidate_race.n_delegates)
            .dots{class: "dots-#{race.party_id}"}= "•" * candidate_race.n_delegates
        - if race.has_pollster_data?
          %td.pollster
            - if candidate_race.poll_sparkline && !candidate_race.poll_sparkline.empty?
              .sparkline!= candidate_race.poll_sparkline.to_svg
            %span.percent= format_percent_or_nil(candidate_race.poll_percent)

- if race.n_votes_is_really_n_sdes
  %p.state-delegate-equivalents.when-past.when-present
    %sup ∗
    The Iowa Democratic Party doesn't report vote counts. It reports State Delegate Equivalents (SDEs), predictions of who will attend the state-wide party convention.

- if race.pollster_last_updated
  %p.poll-last-updated.when-no-precincts-reporting!= "#{race.state_name} poll averages compiled by <a href=\"//elections.huffingtonpost.com/pollster/#{race.pollster_slug}\">HuffPost Pollster</a> at <time datetime=\"#{format_datetime(race.pollster_last_updated)}\"></time>"

.n-delegates.n-delegates-with-candidates
  .dots{class: "dots-#{race.party_id}"}
    %span.with-candidates>= "•" * race.n_delegates_with_candidates
    %span.without-candidates= "•" * race.n_delegates_without_candidates
  %p
    %span.n-delegates-with-candidates-int= format_int(race.n_delegates_with_candidates)
    of
    %span.n-delegates-int= format_int(race.n_delegates)
    delegates accounted for in #{race.state_name}.
  %p
    HuffPost counts unpledged delegates who have publicly stated their intent to vote for a candidate.
    %a{href: '/2016/primaries/about-delegates'} More info &raquo;
