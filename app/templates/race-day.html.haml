-# Called with a RaceDayPageGenerator::HtmlContext
#main
  %h1= hed
  %h3.date-hed= race_date

  .social-buttons
    %a.facebook-share{'target': '_blank'}
      %span.btn-social.btn-facebook
        %img{src: image_path('facebook.svg')}
        Share on Facebook
    %a.twitter-share{'target': '_blank'}
      %span.btn-social.btn-twitter
        %img{src: image_path('twitter.svg')}
        Share on Twitter

  - if body
    %p.intro-copy= body

  %ul.states
    - race_day.state_party_races.each do |state, party_races|
      %li.state
        %ul.party-state
          - party_races.each do |party, race, other_races|
            %li.party-state{'data-party-id': party.id, 'data-state-code': state.code}
              - if !race.nil?
                != render(partial: 'race-day/race', locals: { race: race })
                - other_races.each do |other_race|
                  != render(partial: 'race-day/other-race-below-race', locals: { race: other_race })
              - elsif other_races.length > 0
                != render(partial: 'race-day/other-races', locals: { races: other_races })
              - else
                != render(partial: 'race-day/no-races', locals: { state: state, party: party })

  %div.footnotes.footer
    %p Sources: The Associated Press, Huffpost Pollster
    -if updated_dt
      %p= "Page published #{pubbed_dt} and last updated #{updated_dt}."
    -else
      %p= "Page published #{pubbed_dt}."
    %p By Adam Hooper, Hilary Fung, Shane Shifflett, Nicky Forster and Alissa Scheller

!= render(partial: 'race-day/race-day-nav')

%script{src: asset_path('stats.js')}
%script{src: asset_path('main.js')}
%script{src: asset_path('social.js')}
