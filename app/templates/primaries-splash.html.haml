!!! 5
- dem_list = ['Clinton', 'Sanders', "O'Malley"]
- gop_list = ["Trump", "Christie", "Bush", "Cruz", "Paul", "Rubio", "Carson", "Huckabee", "Kasich", "Fiorina", "Santorum"]
%html{lang: 'en'}
  %meta{charset: 'utf-8'}
  %title Huffington Post 2016 Primary Results
  %link{rel: 'stylesheet', href: asset_path('splash.css')}

%body
  %div.primary-splash-banner
    %div.header
      %h1= "HAPPENING NOW: Iowa Caucus"
      %div.tease-link
        %a{href: "/2016/primaries/#{next_race_day.id}"}= "See live-updating results for the Caucus here."
        %div.arrow-right
    %div.countdown-map-container.left
      %div.countdown
      %div.map
    %div.parties-container.left
      -parties.each do |party|
        - party_abbrev = party.adjective == 'Democratic' ? "dem" : "gop"
        - race = races.find_by_party_and_state(party, cur_state)
        %div{class: "party-container #{party_abbrev} clearfix"}
          -if party.adjective == 'Democratic'
            %div.leading-candidate-img.left
              %img{src: image_path("#{leading_democrat.slug}.png"), alt: ''}
            %div.leading-candidate-delegates.left
              %p.frontrunner-lbl="DEMOCRATIC FRONTRUNNER"
              %p.frontrunner-cd= "#{leading_democrat.name}: #{leading_democrat.n_delegates} delegates"
          -else
            %div.leading-candidate-img.left
              %img{src: image_path("#{leading_republican.slug}.png"), alt: ''}
            %div.leading-candidate-delegates.left
              %p.frontrunner-lbl="REPUBLICAN FRONTRUNNER"
              %p.frontrunner-cd= "#{leading_republican.name}: #{leading_republican.n_delegates} delegates"
          %div.candidate-position-listing.left.clearfix
            %div.candidate-delegates-lbl
              %p= "VOTES"
            - race.candidate_states.each_with_index do |cd_state, idx|
              - cd = cd_state.candidate
              - if (party_abbrev == 'gop' and gop_list.include? cd.name) or (party_abbrev == 'dem' and dem_list.include? cd.name)
                %div.left.candidate{'data-candidate-id': cd.id}
                  %table
                    %tr
                      %td= cd.name
                      %td= rand(0..100000).to_s.reverse.gsub(/(\d{3})(?=\d)/, '\\1,').reverse#cd_state.n_votes
                - if party_abbrev == 'gop' and race.candidate_states.count - 1 == idx
                  %div.left.candidate{'data-candidate-id': 99}
                    %table
                      %tr
                        %td.see-all{:colspan => 3}
                          %a{href:"/2016/primaries/#{next_race_day.id}"}= "All candidates"
